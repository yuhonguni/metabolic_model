metabolic_ID<-read.table('metabolic_ID.txt',header =T, stringsAsFactors = F, sep = '\t')
metabolic_ID
View(metabolic_ID)
met_model_gene_ID<-read.table('NSC_model_gene_ID.txt',header =T, stringsAsFactors = F, sep = '\t')
met_model_gene_ID
metabolic_ID
Gene_metabolic_classification<-read.table('Gene_metabolic_classification.txt',header = F, sep = '\t')
Gene_metabolic_classification
NSC_metabolic_ineraction<-read.table('NSC_metabolic_interaction.txt',header =F, sep = '\t')
NSC_metabolic_ineraction
length(NSC_metabolic_ineraction[1,])
c(1:length(NSC_metabolic_ineraction[,1])
)
x<-list()
x
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
x[[NSC_metabolic_ineraction[i,1]]] = NSC_metabolic_ineraction[i,2]
}
i
toString(1)
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
x[[toString(NSC_metabolic_ineraction[i,1])]] = NSC_metabolic_ineraction[i,2]
}
x
x<-list()
x[[1]]
x[[1]] == 1
x[['1']] == 1
x[['1']] == 2
x[['1']] == NA
x<-list()
x<-list()
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
if (x[[toString(NSC_metabolic_ineraction[i,2])]] == NSC_metabolic_ineraction[i,1]) {
next
} else if (NSC_metabolic_ineraction[i,2] == NSC_metabolic_ineraction[i,1]) {
next
} else {
x[[toString(NSC_metabolic_ineraction[i,1])]] = NSC_metabolic_ineraction[i,2]
}
}
is.na(x[['1']])
is.na(1)
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
x[[toString(NSC_metabolic_ineraction[i,1])]] = NSC_metabolic_ineraction[i,2]
}
length(x)
x
NSC_metabolic_ineraction
NSC_metabolic_ineraction
library(hash)
install.packages('hash')
library('hash')
# initialize hash
hash <- new.env(hash = TRUE, parent = emptyenv(), size = 100L)
hash
?paste
paste(NSC_metabolic_ineraction[1,1]),'+',NSC_metabolic_ineraction[1,2]))
paste(NSC_metabolic_ineraction[1,1],'+', NSC_metabolic_ineraction[1,2])
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
x <- paste(NSC_metabolic_ineraction[i,1],'+',NSC_metabolic_ineraction[i,2])
y <- paste(NSC_metabolic_ineraction[i,2],'+',NSC_metabolic_ineraction[i,1])
if (x == y) { next} else if (exists_hash(y, hash)) {next}
else (assign_hash(x, y, hash))
}
?hash
# initialize hash
h <-hash()
?has.key
for (i in c(1:length(NSC_metabolic_ineraction[,1]))) {
x <- paste(NSC_metabolic_ineraction[i,1],'+',NSC_metabolic_ineraction[i,2])
y <- paste(NSC_metabolic_ineraction[i,2],'+',NSC_metabolic_ineraction[i,1])
if (x == y) { next} else if (has.key(y, h)) {next}
else (.set(h, keys=x, values=y))
}
h
h.keys
h.key
ls(hash)
ls(h)
metabolic_interact<-data.frame(ls(h))
metabolic_interact
?substring
?strsplit
strsplit(metabolic_interact[,1],' + ')
metabolic_interact[,1]
metabolic_interact<-data.frame(ls(h),stringsAsFactors=FALSE)
strsplit(metabolic_interact[,1],' + ')
metabolic_interact
strsplit(metabolic_interact[,1],'+')
strsplit(metabolic_interact[,1],' + ',fixed = T)
data.frame(strsplit(metabolic_interact[,1],' + ',fixed = T))
metabolic_interact<-ls(h)
strsplit(metabolic_interact[,1],' + ',fixed = T)
metabolic_interact
strsplit(metabolic_interact,' + ',fixed = T)
strtoi(strsplit(metabolic_interact,' + ',fixed = T))
strsplit(metabolic_interact,' + ',fixed = T)
unlist(strsplit(metabolic_interact,' + ',fixed = T))
data.frame(unlist(strsplit(metabolic_interact,' + ',fixed = T)),ncol=2)
matrix(unlist(strsplit(metabolic_interact,' + ',fixed = T)),ncol=2)
matrix(unlist(strsplit(metabolic_interact,' + ',fixed = T)),ncol=2,byrow=T)
metabolic_interact<-matrix(unlist(strsplit(metabolic_interact,' + ',fixed = T)),ncol=2,byrow=T)
metabolic_interact<-data.frame(metabolic_interact,stringsAsFactors = F)
metabolic_interact
met_model_gene_ID
Gene_metabolic_classification
metabolic_interact
met_model_gene_ID
metabolic_ID
H_Meta_gene_ID
metabolic_ID
substr(NSC_metabolic_ineraction[,2], nchar(NSC_metabolic_ineraction[,2])-1, nchar(NSC_metabolic_ineraction[,2]))
NSC_metabolic_ineraction[,2]
NSC_metabolic_ineraction
substr(metabolic_ID[,2], nchar(metabolic_ID[,2])-1, nchar(metabolic_ID[,2]))
substr(metabolic_ID[,2], nchar(metabolic_ID[,2]), nchar(metabolic_ID[,2]))
metabolic_ID$compartment<-substr(metabolic_ID[,2], nchar(metabolic_ID[,2]), nchar(metabolic_ID[,2]))
metabolic_ID
metabolic_ID$meta_name<-paste(metabolic_ID$met_Name,'[',metabolic_ID$compartment,']',sep ='')
metabolic_ID$meta_name
metabolic_ID
metabolic_ID
metabolic_interact
metabolic_interact
?left_join
?left_join
metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') )
library(dplyr)
metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') )
metabolic_interact
strtoi(metabolic_interact)
strtoi(metabolic_interact$X1)
metabolic_interact$X1<-strtoi(metabolic_interact$X1)
metabolic_interact$X2<-strtoi(metabolic_interact$X2)
metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') )
metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') ) %>%
left_join(metabolic_ID[,c(1,5)],by=c('X2'='Num') )
metabolic_interact_name<-metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') ) %>%
left_join(metabolic_ID[,c(1,5)],by=c('X2'='Num') )
View(metabolic_interact_name)
metabolic_interact_name<-metabolic_interact %>% left_join(metabolic_ID[,c(1,5)],by=c('X1'='Num') ) %>%
left_join(metabolic_ID[,c(1,5)],by=c('X2'='Num') ) %>% select(meta_name.x,meta_name.y)
View(metabolic_interact_name)
met_model_gene_ID
Gene_metabolic_classification
met_model_gene_ID
Gene_metabolic_classification
met_model_gene_ID
View(met_model_gene_ID)
View(Gene_metabolic_classification)
Gene_metabolic_classification %>% left_join(met_model_gene_ID,by=c('V1'='Num'))
Gene_metabolic_classification %>% left_join(met_model_gene_ID,by=c('V1'='Num')) %>% left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') )
library(org.Hs.eg.db)
k<-keys(org.Hs.eg.db,keytype='ENSEMBL')
en2ENSE<-AnnotationDbi::select(org.Hs.eg.db,keys=k,
columns=c("ENTREZID",'SYMBOL'),
keytype = 'ENSEMBL')
en2ENSE
Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))
Gene_metabolic<-Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))  %>%
select(meta_name,SYMBOL)
Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))  %>%
select(meta_name,SYMBOL)
Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))
Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))  %>%
dplyr::select(meta_name,SYMBOL)
Gene_metabolic<-Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))  %>%
dplyr::select(meta_name,SYMBOL)
Gene_metabolic<-Gene_metabolic_classification %>%
left_join(met_model_gene_ID,by=c('V1'='Num')) %>%
left_join(metabolic_ID[,c(1,5)],by=c('V2'='Num') ) %>%
left_join(en2ENSE,by=c('gene_ID'='ENSEMBL'))  %>%
dplyr::select(meta_name,gene_ID,SYMBOL)
Gene_metabolic
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',header=T,stringsAsFactors = F)
View(gene_DE_cp2a)
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',sep=' ',header=T,stringsAsFactors = F)
View(gene_DE_cp2a)
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',sep='\t',header=T,stringsAsFactors = F)
View(gene_DE_cp2a)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue)
View(gene_DE_cp2a)
Gene_metabolic
Gene_metabolic[,1]
View(Gene_metabolic)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue) %>%
right_join(Gene_metabolic, by=c('EnsemblID'='gene_ID'))
View(Gene_DE_cp2a)
View(Gene_DE_cp2a)
View(gene_DE_cp2a)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue) %>%
right_join(Gene_metabolic[,c(2,3)], by=c('EnsemblID'='gene_ID'))
View(gene_DE_cp2a)
View(gene_DE_cp2a)
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',
sep='\t',header=T,stringsAsFactors = F)
gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))
Gene_metabolic[,c(2,3)]
gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue)
gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue) %>%
right_join(Gene_metabolic[,c(2,3)], by=c('EnsemblID'='gene_ID'))
Gene_metabolic %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID''))
Gene_metabolic %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
Gene_metabolic %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue)
Gene_metabolic %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
Gene_metabolic
met_model_gene_ID<
)
met_model_gene_ID
View(met_model_gene_ID)
met_model_gene_ID %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
gene_p_value<-met_model_gene_ID %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
View(gene_p_value)
gene_p_value %>% filter(padj<0.05)
gene_p_value %>% filter(padj<0.05 && isNA(padj))
gene_p_value %>% filter(gene_p_value$padj<0.05 && isNA(gene_p_value$padj))
gene_p_value %>% filter(gene_p_value$padj<0.05 && !isNA(gene_p_value$padj))
gene_p_value %>% filter(gene_p_value$padj<0.05 & isNA(gene_p_value$padj))
gene_p_value %>% filter(gene_p_value$padj<0.05 && (!isNA(gene_p_value$padj))
)
gene_p_value %>% filter(gene_p_value$padj<0.05)
gene_p_value_DE<-gene_p_value %>% filter(gene_p_value$padj<0.05)
View(gene_p_value_DE)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
left_join(en2ENSE,by=c('EnsemblID'='ENSEMBL'))  %>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue)
gene_DE_cp2a
en2ENSE
## gene p values import
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',
sep='\t',header=T,stringsAsFactors = F)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
left_join(en2ENSE,by=c('EnsemblID'='ENSEMBL'))  %>%
dplyr::select(EnsemblID,log2FoldChange,padj,pvalue)
en2ENSE
## gene p values import
gene_DE_cp2a<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-CP2A_vs_NSC-CTRL-all.tsv',
sep='\t',header=T,stringsAsFactors = F)
gene_DE_cp2a<-gene_DE_cp2a%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
left_join(en2ENSE,by=c('EnsemblID'='ENSEMBL'))  %>%
dplyr::select(EnsemblID,SYMBOL,log2FoldChange,padj,pvalue)
gene_DE_cp2a
gene_p_value<-met_model_gene_ID %>% left_join(gene_DE_cp2a,by=c('gene_ID'='EnsemblID'))
gene_p_value_DE<-gene_p_value %>% filter(gene_p_value$padj<0.05)
gene_p_value_DE
##
library(clusterProfiler)
wpgmtfile <- system.file("extdata/wikipathways-20180810-gmt-Homo_sapiens.gmt", package="clusterProfiler")
wpgmtfile
wpgmtfile <- system.file("extdata/wikipathways-20180810-gmt-Homo_sapiens.gmt", package="clusterProfiler")
wp2gene <- read.gmt(wpgmtfile)
wp2gene <- wp2gene %>% tidyr::separate(ont, c("name","version","wpid","org"), "%") %>%
filter(gene %in% Gene_ID_ENTREZ$ENTREZID)
wp2gene %>% tidyr::separate(ont, c("name","version","wpid","org"), "%")
?enricher
Gene_metabolic
Gene_metabolic_classification
Gene_metabolic[,c(1,2)]
TERM2NAME = Gene_metabolic[,c(1,1)]
Gene_metabolic[,c(1,1)]
View(Gene_metabolic[,c(1,1)]
)
enricher(gene_p_value_DE$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 0.05, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
Gene_metabolic[,c(1,2)]
gene_p_value_DE$gene_ID
TERM2NAME = Gene_metabolic[,c(1,1)]
enricher(gene_p_value_DE$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
gene_p_value_DE_down<-gene_p_value %>% filter(gene_p_value$padj<0.05,
gene_p_value$log2FoldChange<0)
enricher(gene_p_value_DE$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x1<-enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x1<-enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 0.05, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
barplot(x1)
x1
barplot(x1, showCategory = 12)
gene_p_value_DE_up<-gene_p_value %>% filter(gene_p_value$padj<0.05,
gene_p_value$log2FoldChange<0)
gene_p_value_DE_up<-gene_p_value %>% filter(gene_p_value$padj<0.05,
gene_p_value$log2FoldChange>0)
x2<-enricher(gene_p_value_DE_up$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 0.05, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x2
x2<-enricher(gene_p_value_DE_up$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
barplot(x2, showCategory = 12)
gene_DE_alpers<-read.csv('/home/yu/Postdoc_project/NSC_RNAseq/RNA_seq/Yu_tables/DE_NSC-ALPERSvs_NSC-CTRL-all.tsv',
sep='\t',header=T,stringsAsFactors = F)
gene_DE_alpers<-gene_DE_alpers%>%
mutate(EnsemblID = gsub('[.][0-9]+$','',.$EnsemblID))%>%
left_join(en2ENSE,by=c('EnsemblID'='ENSEMBL'))  %>%
dplyr::select(EnsemblID,SYMBOL,log2FoldChange,padj,pvalue)
gene_p_value<-met_model_gene_ID %>% left_join(gene_DE_alpers,by=c('gene_ID'='EnsemblID'))
gene_p_value_DE_down<-gene_p_value %>% filter(gene_p_value$padj<0.05,
gene_p_value$log2FoldChange<0)
gene_p_value_DE_up<-gene_p_value %>% filter(gene_p_value$padj<0.05,
gene_p_value$log2FoldChange>0)
x1<-enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x1
x2<-enricher(gene_p_value_DE_up$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 5, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x2
barplot(x2, showCategory = 12)
barplot(x1, showCategory = 12)
gene_p_value_DE_down
x1<-enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 1, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x2<-enricher(gene_p_value_DE_up$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 1, maxGSSize = 500,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
barplot(x2, showCategory = 12)
barplot(x1, showCategory = 12)
x1<-enricher(gene_p_value_DE_down$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 1, maxGSSize = 1000,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
x2<-enricher(gene_p_value_DE_up$gene_ID, pvalueCutoff = 0.05,pAdjustMethod = "BH",
qvalueCutoff = 1, minGSSize = 1, maxGSSize = 1000,
TERM2GENE = Gene_metabolic[,c(1,2)], TERM2NAME = Gene_metabolic[,c(1,1)])
barplot(x1, showCategory = 12)
View(Gene_metabolic[,c(1,1)])
barplot(x2, showCategory = 12)
